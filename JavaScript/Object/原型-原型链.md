# åŸå‹-åŸå‹é“¾

### å¼•è¨€

â€‹	è€ƒè™‘è¿™ä¹ˆä¸€ç§åœºæ™¯ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºå¾ˆå¤šä¸ªå­¦ç”Ÿå®ä¾‹ï¼Œå®ƒä»¬æœ‰è‹¥å¹²ç›¸åŒçš„å±æ€§å’Œæ–¹æ³•ï¼Œå¦‚ `name`ã€`age`ã€`study()`ã€`run()` ç­‰ç­‰ã€‚æˆ‘ä»¬åˆæ­¥æƒ³åˆ°çš„æ–¹æ¡ˆæ˜¯è¿™æ ·çš„ã€‚æ•´ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨å‡½æ•°å†…åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œå°†è¿™äº›å±æ€§å’Œæ–¹æ³•ç­‰éƒ½åŠ åˆ°è¿™ä¸ªå¯¹è±¡ä¸Šï¼Œæœ€åè¿”å›ã€‚å¤§è‡´å¦‚ä¸‹ï¼š

```javascript
function createStu(name, age) {
  const obj = {};
  obj.name = name;
  obj.age = age;
  obj.study = ()=> { console.log('studying~ğŸ“š') };
  obj.run = ()=> { console.log('running~ğŸ’¨'); };
  return obj;
}
```

â€‹	æ¯æ¬¡æˆ‘ä»¬æƒ³è¦åˆ›å»ºå­¦ç”Ÿå®ä¾‹æ—¶ï¼Œå°±è°ƒç”¨ä¸Šé¢çš„æ–¹æ³•ã€‚

â€‹	ä½†æˆ‘ä»¬ç¨åŠ æ€ç´¢å°±èƒ½å‘ç°ï¼Œé€šè¿‡ `createStu` æ–¹æ³•åˆ›å»ºå‡ºæ¥çš„å®ä¾‹ï¼Œå®ƒä»¬æ¯ä¸€ä¸ªäººèº«ä¸Šéƒ½å¸¦æœ‰ `study` ä»¥åŠ `run` æ–¹æ³•ï¼Œå¥½åƒæ˜¾å¾—æœ‰äº›å¤šä½™äº†ï¼Œèƒ½ä¸èƒ½æŠŠè¿™äº›æ–¹æ³•æ”¾åˆ°ä¸€ä¸ªç»Ÿä¸€çš„åœ°æ–¹å»ï¼Œæˆ–è€…é€šè¿‡ç»§æ‰¿çš„æ–¹å¼æ‹¿åˆ°å‘¢ï¼Œè¿™æ ·ï¼Œå°±åªæœ‰ä¸€ä»½ `study` ä»¥åŠ `run` æ–¹æ³•äº†ã€‚èŠ‚çœäº†å­˜å‚¨ç©ºé—´ï¼Œä¹Ÿè®©ä»£ç ç®€æ´äº†ä¸å°‘ã€‚

â€‹	åœ¨ JavaScript ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åŸå‹é“¾çš„æ–¹å¼æ¥å®ç°æˆ‘ä»¬ä¸Šé¢æƒ³è¦çš„æ•ˆæœï¼Œå¯ä»¥é€šè¿‡åˆ›å»ºæ„é€ å‡½æ•°ï¼Œå¹¶é€šè¿‡ä¸€äº›æ“ä½œå®ç°ç»§æ‰¿ï¼Œå†ç”¨ `new` è°ƒç”¨æ„é€ å‡½æ•°ï¼Œè¿™æ ·åˆ›å»ºå‡ºæ¥çš„å­¦ç”Ÿå®ä¾‹è‡ªèº«å°±ä¸æºå¸¦è¿™äº›æ–¹æ³•äº†ï¼Œä½†å´å¯ä»¥ä½¿ç”¨åˆ°è¿™äº›æ–¹æ³•ã€‚

### åŸå‹çš„åˆ†ç±»

â€‹	åœ¨åˆšåˆšè°ˆåˆ°çš„ä¾‹å­ä¸­ï¼Œæ¶‰åŠä¸¤ä¸ªä¸»è¦è§’è‰²ï¼Œåˆ†åˆ«æ˜¯æ„é€ å‡½æ•°å’Œè¢«åˆ›å»ºå‡ºæ¥çš„å®ä¾‹ã€‚é‚£äº›å­¦ç”Ÿå®ä¾‹è‡ªèº«ä¸æºå¸¦ `study` æ–¹æ³•å´å¯ä»¥ä½¿ç”¨ï¼Œè¿™å°±æ˜¯ JS åŸå‹å’ŒåŸå‹é“¾çš„æœºåˆ¶ã€‚

â€‹	åœ¨ JS ä¸­ï¼Œæœ‰ `æ˜¾ç¤ºåŸå‹` å’Œ `éšå¼åŸå‹` ä¸¤ç§ã€‚

â€‹	æ„é€ å‡½æ•°çš„åŸå‹å«åš `æ˜¾ç¤ºåŸå‹`ï¼Œå®ä¾‹çš„åŸå‹å«åš `éšå¼åŸå‹`ã€‚

â€‹	æˆ‘ä»¬çŸ¥é“ï¼ŒJS ä¸­å¯ä»¥é€šè¿‡ new è°ƒç”¨æ„é€ å‡½æ•°å¹¶ç”Ÿæˆå®ä¾‹å¯¹è±¡ï¼Œè€Œä¸”æ˜¯å®ç°ç»§æ‰¿æ•ˆæœçš„ï¼Œé‚£åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å‘ç”Ÿäº†ä»€ä¹ˆå‘¢ï¼Œä¸»è¦æœ‰ 4 æ­¥ã€‚

> 1ï¸âƒ£ï¼šä¸€ä¸ªç©ºå¯¹è±¡è¢«åˆ›å»ºå‡ºæ¥
>
> 2ï¸âƒ£ï¼šè¯¥ç©ºå¯¹è±¡çš„åŸå‹ [[Prototype]] è¢«èµ‹å€¼ä¸ºå…¶æ„é€ å‡½æ•°çš„ prototype å±æ€§
>
> 3ï¸âƒ£ï¼šç„¶å this æŒ‡å‘è¯¥å¯¹è±¡
>
> 4ï¸âƒ£ï¼šæ‰§è¡Œæ„é€ å‡½æ•°å‡½æ•°ä½“ï¼Œæœ€åè¿”å›å¯¹è±¡
>
> P.S. æ ¹æ®æ„é€ å‡½æ•°æœ¬èº«è¿”å›å¯¹è±¡åˆåˆ†ä¸ºä¸¤ç§æƒ…å†µ
>
> 1. è¿”å›å¯¹è±¡ï¼Œé‚£æœ€ç»ˆè¿”å›å°±æ˜¯è¿™ä¸ªå¯¹è±¡
> 2. è¿”å›åŸºç¡€ç±»å‹ï¼Œå¦‚ String ä¹‹ç±»çš„ï¼Œé‚£æœ€ç»ˆè¿”å›ä¸Šé¢é‚£ä¸ªè¢«åˆ›å»ºå‡ºæ¥çš„å¯¹è±¡
> 3. ä¸è¿”å›ä»»ä½•ä¸œè¥¿ï¼Œé‚£æœ€ç»ˆè¿”å›å€¼å°±æ˜¯ä¸Šé¢é‚£ä¸ªè¢«åˆ›å»ºå‡ºæ¥çš„å¯¹è±¡

â€‹	è¿™é‡Œç»™å‡ºä¸€ä¸ªå®é™…çš„ä¾‹å­

```javascript
function Student(name, age) {
  this.name = name;
  this.age = age;
}

Student.prototype.study = function() {
  console.log('studying~ğŸ“š');
}
Student.prototype.run = function() {
  console.log('running~ğŸ’¨');
}

const s1 = new Student('John', 20);
s1.study(); // 'studying~ğŸ“š'
s1.run(); // 'running~ğŸ’¨'
// åœ¨æˆ‘ä»¬ new Student() å
// 1. é¦–å…ˆä¸€ä¸ªç©ºå¯¹è±¡åˆ›å»º {}
// 2. {}.__proto__ = Student.prototype
// 3. this æŒ‡å‘ ç©ºå¯¹è±¡
// 4. æ‰§è¡Œæ„é€ å‡½æ•°å‡½æ•°ä½“å¹¶è¿”å›
// { name:'John', age:20 }

// æ³¨æ„ï¼Œä¸Šé¢çš„ __proto__ æœ€å¥½ä¸è¦ç›´æ¥ç”¨ï¼Œå› ä¸ºè¿™ä¸ªæ˜¯æµè§ˆå™¨çš„å®ç°ï¼Œå¯èƒ½ä¼šæœ‰å…¼å®¹é—®é¢˜ï¼Œåœ¨ç°å®ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¸ç›´æ¥ç”¨ __proto__ã€‚
// è¿™é‡Œä»…ä½œä¸ºæ¼”ç¤º
```

### ç»å…¸è§£è¯»

![prototype chain image](E:\Mr.Cow-NoteBook-FE\JavaScript\Object\PrototypeChain.png)

â€‹	ç›¸ä¿¡æˆ‘ä»¬å¯¹è¿™ä¸€å‰¯å¹¿ä¸ºæµä¼ çš„å›¾éƒ½ä¸é™Œç”Ÿã€‚

â€‹	å½“æ—¶ä¸ºäº†å­¦ä¹  JS ä¸­çš„åŸå‹å’ŒåŸå‹é“¾çš„æ¦‚å¿µï¼Œå°±å››å¤„æœç´¢ï¼Œæœ€åå‘ç°è¿™å¼ å›¾å‡ºç°çš„é¢‘ç‡æœ€é«˜ï¼ŒåŒæ—¶ä¹Ÿæœ‰è®¸å¤šè®²è§£åŸå‹é“¾çš„å›¾ç‰‡ï¼Œä½†å¤§å·®ä¸å·®ã€‚æˆ‘å°±ä»¥è¿™ä¸€å¼ ä¸ºä¾‹å­ï¼Œè®²ä¸€ä¸‹æˆ‘çš„æµ…è–„è§è§£ã€‚

#### #1ï¼šæœ¯è¯­é˜è¿°

â€‹	ä¸Šé¢è¿™å¼ å›¾è¢«åˆ†ä¸ºäº†å·¦ä¸­å³ä¸‰ä¸ªéƒ¨åˆ†ï¼Œå·¦è¾¹æˆ‘ä»¬æš‚ä¸”ç§°ä¸º**å®ä¾‹å¯¹è±¡**ï¼Œä¸­é—´ç§°ä¸º**æ„é€ å‡½æ•°**ï¼Œå³è¾¹ç§°ä¸º**åŸå‹**ã€‚

â€‹	æœ¯è¯­åˆæœ‰ä¸‰ä¸ªï¼Œåˆ†åˆ«æ˜¯ **`__proto__`**ã€**`prototype`**ã€**`constructor`**ã€‚

â€‹	`å®ä¾‹å¯¹è±¡`å®¹æ˜“ç†è§£ï¼Œå°±æ˜¯æˆ‘ä»¬é€šè¿‡ `new` åˆ›å»ºå‡ºæ¥çš„ï¼Œè€Œæˆ‘ä»¬åˆè®²äº† `new` çš„æ—¶å€™å‘ç”Ÿäº†å‡ ä»¶äº‹æƒ…ï¼Œå…¶ä¸­å°±æ¶‰åŠåˆ°äº† `åŸå‹`ã€‚å®ä¾‹å¯¹è±¡æ‹¥æœ‰éšå¼åŸå‹ `__proto__`ï¼Œå®ƒæŒ‡å‘æ„é€ å‡½æ•°çš„æ˜¾ç¤ºåŸå‹ `prototype`ã€‚

â€‹	æ³¨æ„ï¼šå®ä¾‹å¯¹è±¡åªæœ‰éšå¼åŸå‹ï¼Œè€Œæ„é€ å‡½æ•°åŒæ—¶æ‹¥æœ‰æ˜¾å¼åŠéšå¼åŸå‹~

#### #2ï¼šä¾‹å­è§£é‡Š

â€‹	å¯¹äºå›¾ä¸­çš„ `f1 å’Œ f2`ï¼Œå®ƒä»¬éƒ½æ˜¯é€šè¿‡æ„é€ å‡½æ•° `function Foo` åˆ›å»ºçš„ã€‚æ‰€ä»¥ `f1 å’Œ f2` çš„éšå¼åŸå‹æŒ‡å‘ `function Foo` çš„æ˜¾å¼åŸå‹ `Foo.prototype`ã€‚ï¼ˆ å³ *f1.__proto === Foo.prototype* ï¼‰

â€‹	ä¸”å¯¹äºæ˜¾ç¤ºåŸå‹  `Foo.prototype` å®ƒè¿˜å…·æœ‰ `constructor` å±æ€§ï¼ŒæŒ‡å› `function Foo`ã€‚ï¼ˆ å³  *Foo.prototype.constructor === Foo* ï¼‰

â€‹	å¯¹äºæ˜¾å¼åŸå‹ `Foo.prototype`ï¼Œå®ƒè‡ªèº«ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹äºä¸€ä¸ªå¯¹è±¡æ¥è¯´ï¼Œå®ƒè‡ªç„¶ä¹Ÿæœ‰éšå¼åŸå‹ï¼Œå›¾ä¸­ä¹Ÿç”»å‡ºæ¥äº†ã€‚

â€‹	å³ `Foo.prototype.__proto__ ä¸º Object.prototype`ã€‚åŒç†ï¼Œ`Object.protoype` æœ¬èº«äº¦ä¸ºå¯¹è±¡ï¼Œè‡ªç„¶å®ƒä¹Ÿæœ‰éšå¼åŸå‹ï¼Œä½†ä»”ç»†ä¸€æƒ³ï¼Œè¿™æ ·ä¸å°±æ— ç©·æ— å°½äº†å—ï¼Œåƒä¿„ç½—æ–¯å¥—å¨ƒä¸€æ ·ï¼Œè‚¯å®šå¾—æœ‰ä¸€ä¸ªå°½å¤´ï¼Œæ•… `Object.prototype.__proto ä¸º null`ã€‚

#### #3ï¼šæ„é€ å‡½æ•°çš„åŸå‹

â€‹	é€šè¿‡ä¸Šé¢å¯¹ `f1` çš„åŸå‹é“¾è§£é‡Šï¼Œæˆ‘ä»¬ä¸éš¾ç†è§£æ„é€ å‡½æ•°çš„åŸå‹é“¾æ„æˆã€‚

â€‹	è¿™é‡Œæ‹¿æ„é€ å‡½æ•° `function Foo` ä¸ºä¾‹ï¼Œä»å›¾ä¸­å¯çŸ¥ï¼Œæ­£å¦‚ä¸€ä¸ªæ™®é€šå¯¹è±¡çš„åˆ›å»ºéœ€è¦åŸå‹ä¸€æ ·ï¼Œä¸€ä¸ªæ„é€ å‡½æ•°åŒæ ·ä¹Ÿéœ€è¦ã€‚è¿™é‡Œ `function Foo` ä¹Ÿå…·æœ‰éšå¼åŸå‹ `__proto__`ï¼Œè¿™é‡ŒæŒ‡å‘ `Function.prototype`ã€‚

â€‹	å…¶ä»–çš„æ™®é€šå‡½æ•°æˆ–è€…æ„é€ å‡½æ•°éƒ½æ˜¯ç”±è¿™ä¸ª `Function` æ„é€ å‡½æ•°åˆ›å»ºå‡ºæ¥çš„ï¼ˆè¿™é‡Œé™¤å»å¼‚æ­¥å‡½æ•°ï¼Œæƒ³è¿›ä¸€æ­¥äº†è§£å¼‚æ­¥å‡½æ•°çš„å¯ä»¥çœ‹çœ‹è¿™ä¸ª [MDNçš„è§£é‡Š](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/AsyncFunction)ï¼‰

â€‹	åŒç† `Function` æœ¬èº«ä¹Ÿæœ‰æ˜¾å¼åŸå‹ï¼Œå³ `Function.prototype`ï¼ŒåŒæ—¶ä¹Ÿè¦æœ‰éšå¼åŸå‹ã€‚ä½†è¿™ä¸ªéšå¼åŸå‹åˆ°åº•æ˜¯å•¥ï¼ŒJS è®¾è®¡çš„æ˜¯ `Function.__proto__ ä¸º Function.prototype`ï¼Œè¿™é‡Œæ˜¯ä¸æ˜¯æœ‰ç§æˆ‘è‡ªå·±åˆ›é€ è‡ªå·±çš„æ„Ÿè§‰ğŸ˜ï¼Œæ²¡é”™ï¼ŒJS å°±æ˜¯è¿™ä¹ˆâ€œç¥å¥‡â€ï¼Œå“ˆå“ˆå“ˆã€‚ä¸ç„¶ä¹Ÿæ²¡æœ‰è§£å†³åŠæ³•äº†ï¼Œæ€»ä¸èƒ½æ²¡å®Œæ²¡äº†äº†å§ï¼Œæ€»è¯¥æœ‰ä¸ªå¤´ï¼Œå°±åƒ Object.prototype çš„éšå¼åŸå‹ä¸º null ä¸€æ ·ã€‚

#### #4ï¼šå°è¯•ç‰›åˆ€

â€‹	çœ‹äº†è¿™ä¹ˆå¤šç†è®ºï¼Œæ˜¯æ—¶å€™ç»ƒä¹ ç»ƒä¹ äº†ï¼Œæˆ‘ç»™å‡ºäº†ä¸€äº›é¢˜ç›®ï¼Œå¤§å®¶å¯ä»¥åˆ©ç”¨åˆšåˆšå­¦åˆ°çš„çŸ¥è¯†å°è¯•ä¸€ä¸‹~

```javascript
function P() {
  this.x = 'xxxx';
  this.y = 'yyyy';
  this.run = () => { console.log('running~ğŸ’¨'); };
}
P.prototype.z		= 'zzzz';
P.prototype.run = () => { console.log('proto-running~ğŸ’¨'); };
P.prototype.eat = () => { console.log('eating~ğŸ¥'); };

const p1 = new P();

console.log(p1.x) // ?
console.log(p1.z) // ?
console.log(p1.run()) // ?
console.log(p1.eat === undefined); // ?

// æ­£ç¡®ç­”æ¡ˆï¼š
// 'xxxx'
// 'zzzz'
// 'running~ğŸ’¨'
// false

// æ€»ç»“ï¼šè‡ªå·±æœ‰çš„å±æ€§æˆ–æ–¹æ³•ï¼Œå°±ç”¨è‡ªå·±çš„ã€‚
// 			è‹¥æ²¡æœ‰ï¼Œå°±æ²¿ç€ __proto__ å¾€ä¸Šæ‰¾
```

â€‹	è¿™é‡Œå†æ¥å‡ é“å§

```javascript
console.log(Array.prototype.constructor) // ?
console.log([].constructor) // ?
console.log({}.constructor === Array.prototype.__proto__.constructor) // ?

const foo = ()=>{}
const hoo = function() {}
const xoo = async ()=> {}
console.log(foo.prototype) // ?
console.log(foo.__proto__ === hoo.__proto__) // ?
console.log(foo.__proto__ === Function.prototype) // ?
console.log(xoo.__proto__ === Function.prototype) // ?
console.log(Array.__proto__ === foo.__proto__) // ?

// æ­£ç¡®ç­”æ¡ˆï¼š
// Array
// Array
// true

// undefined
// true
// true
// false
// true
```

â€‹	æä¸æ¸…æ¥šæˆ–è€…åšé”™äº†ï¼Œå¯ä»¥å†çœ‹ä¸€çœ‹è®²è§£å’Œå›¾ã€‚

# å®Œ~ğŸ‰